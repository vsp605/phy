CREATE VIEW EmployeesWithDependents 
AS
SELECT E.FNAME, E.LNAME
FROM EMPLOYE E
JOIN DEPENDNT D ON E.SSN = D.ESSN;
SELECT * FROM
EmployeesWithDependents;


CREATE VIEW AdminEmployees1 AS
SELECT E.FNAME AS EmployeeName, S.FNAME AS SupervisorName, E.SALARY
FROM EMPLOYE E
JOIN EMPLOYE S ON E.SUPER_SSN = S.SSN
JOIN DEPARTMNT D ON E.DNO = D.DNUMBER
WHERE D.DNAME = 'ADMINISTRATION';
SELECT * FROM AdminEmployees1;


CREATE VIEW BellarieStaffordProjects1 AS
SELECT E.FNAME, E.LNAME, E.SALARY, P.PNAME
FROM EMPLOYE E
JOIN WORKS_ON1 W ON E.SSN = W.ESSN
JOIN PROJET P ON W.PNO = P.PNUMBER
WHERE P.PLOCATION IN ('BELLAIRE', 'STAFFORD');
SELECT * FROM BellarieStaffordProjects1;


CREATE VIEW DepartmentProjects AS
SELECT D.DNAME, M.FNAME AS ManagerName, P.PNAME, E.SALARY
FROM DEPARTMNT D
JOIN EMPLOYE M ON D.MGR_SSN = M.SSN
JOIN PROJET P ON D.DNUMBER = P.DNUM
JOIN WORKS_ON1 W ON P.PNUMBER = W.PNO
JOIN EMPLOYE E ON W.ESSN = E.SSN;
SELECT * FROM DepartmentProjects;


CREATE VIEW DepartmentEmployeeCount AS
SELECT D.DNAME, COUNT(E.SSN) AS EmployeeCount
FROM DEPARTMNT D
JOIN EMPLOYE E ON D.DNUMBER = E.DNO
GROUP BY D.DNAME
HAVING COUNT(E.SSN) > 1;

-- Display the view
SELECT * FROM DepartmentEmployeeCount;



CREATE VIEW ProjectDetails AS
SELECT P.PNAME AS ProjectName, D.DNAME AS DepartmentName, COUNT(W.ESSN) AS NumberOfEmployees, SUM(W.HOURS) AS TotalHoursWorked
FROM PROJET P
JOIN DEPARTMNT D ON P.DNUM = D.DNUMBER
JOIN WORKS_ON1 W ON P.PNUMBER = W.PNO
GROUP BY P.PNAME, D.DNAME;
SELECT * FROM ProjectDetails;


CREATE VIEW Prowithmulemp AS
SELECT P.PNAME AS ProjectName, D.DNAME AS DepartmentName, COUNT(W.ESSN) AS NumberOfEmployees, SUM(W.HOURS) AS TotalHoursWorked
FROM PROJET P
JOIN DEPARTMNT D ON P.DNUM = D.DNUMBER
JOIN WORKS_ON1 W ON P.PNUMBER = W.PNO
GROUP BY P.PNAME, D.DNAME
HAVING COUNT(W.ESSN) > 1;
SELECT * FROM Prowithmulemp;
